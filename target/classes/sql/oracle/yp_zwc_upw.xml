<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="oracle.yp_zwc_upw">

<select id="select_cb_working_master_w" resultType="HashMap">
/* oracle.yp_zwc_upw.select_cb_working_master_w */
SELECT
	A.CODE,
	A.CODE_NAME
FROM TBL_WORKING_MASTER A
WHERE 1=1
AND A.USE_YN = 'Y'
AND SUBSTR(A.CODE, 1, 1) = 'W'
ORDER BY A.BASE_YYYY, TO_NUMBER(REGEXP_REPLACE(A.CODE, '[^0-9]'))
</select>

<select id="select_tbl_working_combined_cost" resultType="HashMap">
/* oracle.yp_zwc_upw.select_tbl_working_combined_cost */
SELECT
	BASE_YYYY,
	RETIREMENT_GRANTS,
	SAFETY_INSURANCE,
	NATIONAL_PENSION,
	HEALTH_INSURANCE,
	LONGTERM_INSURANCE,
	EMPLOYMENT_INSURANCE,
	GENERAL_INCOME_TAX,
	TAX_AFFAIRS_REPORT,
	PROFIT
FROM TBL_WORKING_COMBINED_COST A
WHERE 1=1
AND A.BASE_YYYY = #{BASE_YYYY}
</select>

<select id="select_tbl_working_unit_price" resultType="HashMap">
/* oracle.yp_zwc_upw.select_tbl_working_unit_price */
SELECT
	BASE_YYYY,
	WORKTYPE_CODE,
	BASE_PAY_HOUR,
	BASE_PAY_WORKING_HOUR,
	SATURDAY_HOUR,
	SATURDAY_WEEK,
	SATURDAY_DOUBLE,
	HOLIDAY_HOUR,
	HOLIDAY_WEEK,
	HOLIDAY_DOUBLE,
	NIGHT_HOUR,
	NIGHT_WEEK,
	NIGHT_DOUBLE,
	REGULAR_HOLIDAY_HOUR,
	REGULAR_HOLIDAY_DAY,
	REGULAR_HOLIDAY_DOUBLE,
	ANNUAL_LEAVE_USE_HOUR,
	ANNUAL_LEAVE_USE_DAY,
	ANNUAL_LEAVE_USE_DOUBLE,
	ANNUAL_LEAVE_UNUSE_HOUR,
	ANNUAL_LEAVE_UNUSE_DAY,
	ANNUAL_LEAVE_UNUSE_DOUBLE,
	BASE_PAY_AMOUNT,
	SATURDAY_AMOUNT,
	HOLIDAY_AMOUNT,
	NIGHT_AMOUNT,
	REGULAR_HOLIDAY_AMOUNT,
	ANNUAL_LEAVE_USE_AMOUNT,
	ANNUAL_LEAVE_UNUSE_AMOUNT,
	EXTRA_PAY_AMOUNT,
	PAY_AMOUNT,
	RETIREMENT_GRANTS_AMOUNT,
	SAFETY_INSURANCE_AMOUNT,
	NATIONAL_PENSION_AMOUNT,
	HEALTH_INSURANCE_AMOUNT,
	LONGTERM_INSURANCE_AMOUNT,
	EMPLOYMENT_INSURANCE_AMOUNT,
	GENERAL_INCOME_TAX_AMOUNT,
	TAX_AFFAIRS_REPORT_AMOUNT,
	EXPENSE_AMOUNT,
	UNIT_PRICE_AMOUNT,
	PROFIT_AMOUNT
FROM TBL_WORKING_UNIT_PRICE A
WHERE 1=1
AND A.BASE_YYYY = #{BASE_YYYY}
AND A.WORKTYPE_CODE = #{WORKTYPE_CODE}
</select>

<update id="save_zwc_upw_create">
/* oracle.yp_zwc_upw.save_zwc_upw_create */
MERGE INTO TBL_WORKING_UNIT_PRICE A
USING (
	SELECT
		#{BASE_YYYY} AS BASE_YYYY,
		#{WORKTYPE_CODE} AS WORKTYPE_CODE
	FROM DUAL
) B
ON (
		A.BASE_YYYY = B.BASE_YYYY
	AND A.WORKTYPE_CODE = B.WORKTYPE_CODE
)
WHEN NOT MATCHED THEN
INSERT (
	BASE_YYYY,
	WORKTYPE_CODE,
	BASE_PAY_HOUR,
	BASE_PAY_WORKING_HOUR,
	SATURDAY_HOUR,
	SATURDAY_WEEK,
	SATURDAY_DOUBLE,
	HOLIDAY_HOUR,
	HOLIDAY_WEEK,
	HOLIDAY_DOUBLE,
	NIGHT_HOUR,
	NIGHT_WEEK,
	NIGHT_DOUBLE,
	REGULAR_HOLIDAY_HOUR,
	REGULAR_HOLIDAY_DAY,
	REGULAR_HOLIDAY_DOUBLE,
	ANNUAL_LEAVE_USE_HOUR,
	ANNUAL_LEAVE_USE_DAY,
	ANNUAL_LEAVE_USE_DOUBLE,
	ANNUAL_LEAVE_UNUSE_HOUR,
	ANNUAL_LEAVE_UNUSE_DAY,
	ANNUAL_LEAVE_UNUSE_DOUBLE,
	BASE_PAY_AMOUNT,
	SATURDAY_AMOUNT,
	HOLIDAY_AMOUNT,
	NIGHT_AMOUNT,
	REGULAR_HOLIDAY_AMOUNT,
	ANNUAL_LEAVE_USE_AMOUNT,
	ANNUAL_LEAVE_UNUSE_AMOUNT,
	EXTRA_PAY_AMOUNT,
	PAY_AMOUNT,
	RETIREMENT_GRANTS_AMOUNT,
	SAFETY_INSURANCE_AMOUNT,
	NATIONAL_PENSION_AMOUNT,
	HEALTH_INSURANCE_AMOUNT,
	LONGTERM_INSURANCE_AMOUNT,
	EMPLOYMENT_INSURANCE_AMOUNT,
	GENERAL_INCOME_TAX_AMOUNT,
	TAX_AFFAIRS_REPORT_AMOUNT,
	EXPENSE_AMOUNT,
	UNIT_PRICE_AMOUNT,
	PROFIT_AMOUNT,
	REG_EMP,
	REG_DATE
) VALUES (
	#{BASE_YYYY},
	#{WORKTYPE_CODE},
	TO_NUMBER(REPLACE(#{BASE_PAY_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{BASE_PAY_WORKING_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{SATURDAY_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{SATURDAY_WEEK}, ',', '')),
	TO_NUMBER(REPLACE(#{SATURDAY_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{HOLIDAY_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{HOLIDAY_WEEK}, ',', '')),
	TO_NUMBER(REPLACE(#{HOLIDAY_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{NIGHT_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{NIGHT_WEEK}, ',', '')),
	TO_NUMBER(REPLACE(#{NIGHT_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_DAY}, ',', '')),
	TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_DAY}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_HOUR}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_DAY}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_DOUBLE}, ',', '')),
	TO_NUMBER(REPLACE(#{BASE_PAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{SATURDAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{HOLIDAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{NIGHT_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{EXTRA_PAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{PAY_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{RETIREMENT_GRANTS_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{SAFETY_INSURANCE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{NATIONAL_PENSION_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{HEALTH_INSURANCE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{LONGTERM_INSURANCE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{EMPLOYMENT_INSURANCE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{GENERAL_INCOME_TAX_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{TAX_AFFAIRS_REPORT_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{EXPENSE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{UNIT_PRICE_AMOUNT}, ',', '')),
	TO_NUMBER(REPLACE(#{PROFIT_AMOUNT}, ',', '')),
	#{s_emp_code},
	SYSDATE
)
WHEN MATCHED THEN
UPDATE SET
	BASE_PAY_HOUR = TO_NUMBER(REPLACE(#{BASE_PAY_HOUR}, ',', '')),
	BASE_PAY_WORKING_HOUR = TO_NUMBER(REPLACE(#{BASE_PAY_WORKING_HOUR}, ',', '')),
	SATURDAY_HOUR = TO_NUMBER(REPLACE(#{SATURDAY_HOUR}, ',', '')),
	SATURDAY_WEEK = TO_NUMBER(REPLACE(#{SATURDAY_WEEK}, ',', '')),
	SATURDAY_DOUBLE = TO_NUMBER(REPLACE(#{SATURDAY_DOUBLE}, ',', '')),
	HOLIDAY_HOUR = TO_NUMBER(REPLACE(#{HOLIDAY_HOUR}, ',', '')),
	HOLIDAY_WEEK = TO_NUMBER(REPLACE(#{HOLIDAY_WEEK}, ',', '')),
	HOLIDAY_DOUBLE = TO_NUMBER(REPLACE(#{HOLIDAY_DOUBLE}, ',', '')),
	NIGHT_HOUR = TO_NUMBER(REPLACE(#{NIGHT_HOUR}, ',', '')),
	NIGHT_WEEK = TO_NUMBER(REPLACE(#{NIGHT_WEEK}, ',', '')),
	NIGHT_DOUBLE = TO_NUMBER(REPLACE(#{NIGHT_DOUBLE}, ',', '')),
	REGULAR_HOLIDAY_HOUR = TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_HOUR}, ',', '')),
	REGULAR_HOLIDAY_DAY = TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_DAY}, ',', '')),
	REGULAR_HOLIDAY_DOUBLE = TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_DOUBLE}, ',', '')),
	ANNUAL_LEAVE_USE_HOUR = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_HOUR}, ',', '')),
	ANNUAL_LEAVE_USE_DAY = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_DAY}, ',', '')),
	ANNUAL_LEAVE_USE_DOUBLE = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_DOUBLE}, ',', '')),
	ANNUAL_LEAVE_UNUSE_HOUR = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_HOUR}, ',', '')),
	ANNUAL_LEAVE_UNUSE_DAY = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_DAY}, ',', '')),
	ANNUAL_LEAVE_UNUSE_DOUBLE = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_DOUBLE}, ',', '')),
	BASE_PAY_AMOUNT = TO_NUMBER(REPLACE(#{BASE_PAY_AMOUNT}, ',', '')),
	SATURDAY_AMOUNT = TO_NUMBER(REPLACE(#{SATURDAY_AMOUNT}, ',', '')),
	HOLIDAY_AMOUNT = TO_NUMBER(REPLACE(#{HOLIDAY_AMOUNT}, ',', '')),
	NIGHT_AMOUNT = TO_NUMBER(REPLACE(#{NIGHT_AMOUNT}, ',', '')),
	REGULAR_HOLIDAY_AMOUNT = TO_NUMBER(REPLACE(#{REGULAR_HOLIDAY_AMOUNT}, ',', '')),
	ANNUAL_LEAVE_USE_AMOUNT = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_USE_AMOUNT}, ',', '')),
	ANNUAL_LEAVE_UNUSE_AMOUNT = TO_NUMBER(REPLACE(#{ANNUAL_LEAVE_UNUSE_AMOUNT}, ',', '')),
	EXTRA_PAY_AMOUNT = TO_NUMBER(REPLACE(#{EXTRA_PAY_AMOUNT}, ',', '')),
	PAY_AMOUNT = TO_NUMBER(REPLACE(#{PAY_AMOUNT}, ',', '')),
	RETIREMENT_GRANTS_AMOUNT = TO_NUMBER(REPLACE(#{RETIREMENT_GRANTS_AMOUNT}, ',', '')),
	SAFETY_INSURANCE_AMOUNT = TO_NUMBER(REPLACE(#{SAFETY_INSURANCE_AMOUNT}, ',', '')),
	NATIONAL_PENSION_AMOUNT = TO_NUMBER(REPLACE(#{NATIONAL_PENSION_AMOUNT}, ',', '')),
	HEALTH_INSURANCE_AMOUNT = TO_NUMBER(REPLACE(#{HEALTH_INSURANCE_AMOUNT}, ',', '')),
	LONGTERM_INSURANCE_AMOUNT = TO_NUMBER(REPLACE(#{LONGTERM_INSURANCE_AMOUNT}, ',', '')),
	EMPLOYMENT_INSURANCE_AMOUNT = TO_NUMBER(REPLACE(#{EMPLOYMENT_INSURANCE_AMOUNT}, ',', '')),
	GENERAL_INCOME_TAX_AMOUNT = TO_NUMBER(REPLACE(#{GENERAL_INCOME_TAX_AMOUNT}, ',', '')),
	TAX_AFFAIRS_REPORT_AMOUNT = TO_NUMBER(REPLACE(#{TAX_AFFAIRS_REPORT_AMOUNT}, ',', '')),
	EXPENSE_AMOUNT = TO_NUMBER(REPLACE(#{EXPENSE_AMOUNT}, ',', '')),
	UNIT_PRICE_AMOUNT = TO_NUMBER(REPLACE(#{UNIT_PRICE_AMOUNT}, ',', '')),
	PROFIT_AMOUNT = TO_NUMBER(REPLACE(#{PROFIT_AMOUNT}, ',', '')),
	UPD_EMP = #{s_emp_code},
	UPD_DATE = SYSDATE
</update>

<select id="select_zwc_upw_list_cnt" resultType="Double">
/* oracle.yp_zwc_upw.select_zwc_upw_list_cnt */
SELECT 
    count(*) as cnt
FROM TBL_WORKING_UNIT_PRICE A
INNER JOIN TBL_WORKING_MASTER B
ON A.WORKTYPE_CODE = B.CODE
WHERE  A.BASE_YYYY BETWEEN TO_NUMBER(#{BASE_YYYY_S}) AND TO_NUMBER(#{BASE_YYYY_E})
<if test='WORKTYPE_CODE != null'>
AND A.WORKTYPE_CODE = #{WORKTYPE_CODE}
</if>
</select>

<select id="select_zwc_upw_list" resultType="java.util.HashMap">
/* oracle.yp_zwc_upw.select_zwc_upw_list */
SELECT 
    A.BASE_YYYY,  
    A.BASE_PAY_AMOUNT,
    A.WORKTYPE_CODE,
     B.CODE_NAME,
    A.EXTRA_PAY_AMOUNT,
    A.PAY_AMOUNT,
    A.EXPENSE_AMOUNT,
    A.UNIT_PRICE_AMOUNT
FROM TBL_WORKING_UNIT_PRICE A
INNER JOIN TBL_WORKING_MASTER B
ON A.WORKTYPE_CODE = B.CODE
WHERE  A.BASE_YYYY BETWEEN TO_NUMBER(#{BASE_YYYY_S}) AND TO_NUMBER(#{BASE_YYYY_E})
<if test='WORKTYPE_CODE != null'>
AND A.WORKTYPE_CODE = #{WORKTYPE_CODE}
</if>
ORDER BY B.CODE_NAME, A.BASE_YYYY
</select>


</mapper>